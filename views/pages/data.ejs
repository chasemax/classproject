<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Student Employment</title>
  </head>
    <body>
        <main>
            <header class="p-3 bg-dark text-white">
                <div class="container">
                  <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
                    <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
                      <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
                    </a>
            
                    <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                      <li><a href="/index" class="nav-link px-2 text-secondary">Student Employment</a></li>
                      <li><a href="#" class="nav-link px-2 text-white">View Students</a></li>
                      <li><a href="/reports" class="nav-link px-2 text-white">Reports</a></li>
                      <li><a href="/form" class="nav-link px-2 text-white">Add Student</a></li>
                    </ul>
    
                  </div>
                </div>
              </header>

              <h1>Data</h1>

              <a href="/export"><button class="btn-primary">Export Data To CSV</button></a>

              <table class="table" border="1">
                <tr>
                  <th>Send Authorization Email</th>
                  <th>First Name</th>
                  <th>Last Name</th>
                  <th>International</th>
                  <th>Gender</th>
                  <th>Email Address</th>
                  <th>Expected Hours to Work</th>
                  <th>Semester</th>
                  <th>Year</th>
                  <th>Phone</th>
                  <th>BYU ID</th>
                  <th>Position Type</th>
                  <th>Class Code</th>
                  <th>Employee Record</th>
                  <th>Supervisor</th>
                  <th>Hire Date</th>
                  <th>Pay Rate</th>
                  <th>Last Pay Increase</th>
                  <th>Pay Increase Amount</th>
                  <th>Increase Input Date</th>
                  <th>Year in Program</th>
                  <th>Pay Grad Tuition?</th>
                  <th>Name Change Completed</th>
                  <th>Notes</th>
                  <th>Terminated</th>
                  <th>Termination Date</th>
                  <th>Qualtrics Survey Sent?</th>
                  <th>Submitted eForm</th>
                  <th>eForm Submission Date</th>
                  <th>Authorization to Work Received</th>
                  <th>Authorization to Work Email Sent Date</th>
                  <th>BYU Name</th>
                </tr>
                <script>
                  function myFunction() {
                    document.getElementById("name").style.backgroundColor = "yellow";
                  }
                </script>
              <% results.forEach(row => { %>
                <tr>
                  <!-- change the conditionals to be if the authorization to begin work is not checked and the eForm submission date is greater than a week -->
                  <td><form action="/send/<%= row.BYUID %>" method="POST"><input type="submit" value="Send Email"></form></td>
                  <td><% if(row.AuthorizationRecieved == 0 && row.HireDate < moment().subtract(7, 'days')){ %>
                    <p style="background-color: yellow"><%= row.FirstName %></p><% } else{ %>
                    <%= row.FirstName %><% } %></td>
                    <td><% if(row.AuthorizationRecieved == 0 && row.HireDate < moment().subtract(7, 'days')){ %>
                      <p style="background-color: yellow"><%= row.LastName %></p><% } else{ %>
                      <%= row.LastName %><% } %></td>
                  <td><%= row.International %></td>
                  <td><%= row.Gender %></td>
                  <td><%= row.EmailAddress %></td>
                  <td><%= row.ExpectedHours %></td>
                  <td><%= row.Semester %></td>
                  <td><%= row.YearWorking %></td>
                  <td><%= row.Phone %></td>
                  <td><%= row.BYUID %></td>
                  <td><%= row.PositionType %></td>
                  <td><%= row.ClassCode %></td>
                  <td><%= row.EmployeeRecord %></td>
                  <td><%= row.Supervisor %></td>
                  <td><%= row.HireDate %></td>
                  <td><%= row.PayRate %></td>
                  <td><%= row.LastPayIncrease %></td>
                  <td><%= row.PayIncreaseAmount %></td>
                  <td><%= row.IncreaseInputDate %></td>
                  <td><%= row.YearInProgram %></td>
                  <td><%= row.PayGradTuition %></td>
                  <td><%= row.NameChangeCompleted %></td>
                  <td><%= row.Notes %></td>
                  <td><%= row.Termination %></td>
                  <td><%= row.TerminationDate %></td>
                  <td><%= row.QualtricsSurvey %></td>
                  <td><%= row.EForm %></td>
                  <td><%= row.EFormSubmissionDate %></td>
                  <td><%= row.AuthorizationRecieved %></td>
                  <td><%= row.AuthorizationEmailSentDate %></td>
                  <td><%= row.BYUName %></td>
                </tr>
              <% }); %>
        </main>
    </body>
</html>